![I own you a Promise!](http://marcofranssen.nl/images/5b9577f06bbdfcc4a395ab5c0a8c38c0412a790f.png)

æ¥åˆ°é¥¿äº†ä¹ˆå·²ç»ä¸‰å¤©, ç”Ÿæ´»ä¹Ÿæœ‰äº†äº›å¾®å¦™çš„å˜åŒ–. å…¨å‘˜é…å‘MacBook Proå½“ç„¶æ˜¯ä»¶å¥½äº‹, å¼ºè¿«æˆ‘ä»¬ä¸¢æŽ‰é¼ æ ‡, æ‹¥æŠ±æ›´é«˜æ•ˆçŽ‡çš„å…¨é”®ç›˜+æ‰‹åŠ¿æ“ä½œ, å¯¹äºŽè®²æ±‚æ•ˆçŽ‡çš„æˆ‘æ¥è¯´, å½“ç„¶æ˜¯ä¸¾åŒæ‰‹èµžæˆ(è¯´èµ·è¿™ä¸ª, è§‰å¾—è‡ªå·±è¯¥å­¦å­¦äº”ç¬”äº†...æ¯æ¬¡æ‹¼éŸ³é€‰å­—çš„æ—¶å€™éƒ½å†’å‡ºæ¥è¿™ä¸ªå¿µå¤´, æ‹¼éŸ³é€‰å­—çš„æ—¶å€™å®žåœ¨æ˜¯æµªè´¹æ—¶é—´å•Š...); 

æŠ€æœ¯æ ˆåˆ™ä¸‰å¤§MVVMæ¡†æž¶éƒ½æœ‰, ç›®å‰çœ‹æ¥æˆ‘è®²è´Ÿè´£ä¸€ä¸ªVueä¸ºä¸»çš„é¡¹ç›®; è„šæ‰‹æž¶åˆ™æ˜¯è‡ªå·±æ­å»º, ä¸è¿‡è¯è¯´è„šæ‰‹æž¶è¿™ä¸œè¥¿, ç”¨æŸäººçš„è¯æ¥è¯´, çœŸæ˜¯'ç½‘ä¸Šä¸€æŠ“ä¸€å¤§æŠŠ'. 

æ‡µæ‡µæ‡‚æ‡‚æ’žè¿›å‰ç«¯åœˆå¿«ä¸€å¹´åŠäº†, ä¹Ÿè·¨å…¥äº†æ‰€è°“'ä¸­å¹´äºº'çš„è¡Œåˆ—, è¯¥å¯¹æœªæ¥æœ‰ä¸ªè§„åˆ’äº†. æœ€è¿‘æ•´ç†è‡ªå·±çš„æŠ€æœ¯æ ˆ, å‘çŽ°è‡ªå·±ä¼¼ä¹Žåˆ°äº†ä¸€ä¸ªæ‰€è°“çš„'ç“¶é¢ˆåŒº': äº¤å¾…æˆ‘çš„ä»»åŠ¡, ç”¨çŽ°æœ‰çš„æ¡†æž¶, UIåº“éƒ½èƒ½æ¯”è¾ƒåœ†æ»¡åœ°å®Œæˆ, é¡ºä¾¿è¿˜èƒ½æ¥ä¸ªè°ƒä¼˜å•¥çš„, å¯æ˜¯å†å¾€ä¸‹æ·±ç©¶, åŽ»çœ‹åº“çš„æºç , å“ªæ€•æ˜¯UIåº“çš„ts, è‡ªå·±ä¼¼ä¹Žåˆæ²¡æœ‰é‚£ä¸ªæ°´å¹³å’Œè€å¿ƒ; è™½è¯´è¿™æ˜¯å¾ˆå¤šäººä¸¤ä¸‰å¹´æ‰åº”è¯¥æœ‰çš„çŠ¶æ€, ä½†ä¸è¦å¿˜è®°æˆ‘æ˜¯è¹‰è·Žäº†å°†è¿‘ä¸¤å¹´, å¦‚æžœå¤§å­¦ä¸€æ¯•ä¸šå°±è¿›äº†å‰ç«¯çš„å‘, é‚£åˆ°çŽ°åœ¨åº”è¯¥æœ‰ä¸‰å¹´çš„å·¥ä½œç»éªŒäº†...ç•™å­¦ç”Ÿæ´»å¸¦ç»™æˆ‘çš„å¥½å¤„, ç¬¬ä¸€æ˜¯è‹±æ–‡èƒ½åŠ›å¤§å¤§æé«˜äº† - ä»Žè¿™æ¬¡æ‰¾å·¥ä½œçš„ç»åŽ†æ¥çœ‹, åªè¦è‹±æ–‡(å°¤å…¶æ˜¯å£è¯­)è¿‡ç¡¬, æŠ€æœ¯ä¸Šåªè¦è¯´å¾—è¿‡åŽ», é‚£å¤–ä¼åŸºæœ¬æ˜¯éšä¾¿æŒ‘äº†; å¦‚æžœæŠ€æœ¯ç®—æ˜¯above average, é‚£å°±æ˜¯è¢«æŠ¢æ¥æŠ¢åŽ»çš„èŠ‚å¥; ç¬¬äºŒå‘¢, æ˜¯è®¤è¯†äº†çŽ°åœ¨çš„å¥³æœ‹å‹, è™½ç„¶è¿Ÿåˆ°äº†ä¸¤å¹´, ä½†ä¿ºçš„ç»ˆç©¶æ˜¯ä¿ºçš„, è·‘ä¹Ÿè·‘ä¸æŽ‰ðŸ˜. çŽ°åœ¨å›žæƒ³èµ·é‚£ä¸€å¹´åŠåœ¨è‹±å›½çš„æ—¶å…‰, æ˜¯ç»™çŽ°åœ¨çš„çŠ¶æ€æ‰“ä¸‹äº†ä¸å°‘é•¿è¿œçœ‹æ¥å¥½å¤„å¤šå¤šçš„åŸºç¡€çš„. 

è¯´å›žæ¥è‡ªå·±çš„æŠ€æœ¯é—®é¢˜, è§‰å¾—ä¸€æ—¦è§‰å¾—è‡ªå·±æœ‰è¿™ä¸ªçŠ¶æ€, å¯ä»¥é€‰æ‹©çœ‹æºç , ç»§ç»­æ·±åŒ–è‡ªå·±å¯¹äºŽjsçš„ç†è§£å’Œåº”ç”¨; ç¬¬äºŒä¸ªåˆ™æ˜¯æ‰¾åˆ°è‡ªå·±æ„Ÿå…´è¶£çš„æŠ€æœ¯æ–¹å‘, æ¯”å¦‚æž¶æž„æ‰“åŒ…, webgl, æ€§èƒ½ä¼˜åŒ–ç­‰, ç»§ç»­æ·±ç©¶. è‡ªå·±ç›®å‰å¯¹äºŽé€‰æ‹©å“ªæ¡è·¯è¿˜æ²¡æœ‰ä»€ä¹ˆæ˜Žç¡®çš„æ‰“ç®—, ç›®å‰è¿˜æ˜¯å€¾å‘äºŽç¬¬ä¸€æ¡è·¯ - é˜…è¯»æºç , å¼ºåŒ–è‡ªå·±çš„ä»£ç æ°´å¹³å’Œç»„ç»‡èƒ½åŠ›. å¸Œæœ›å‡ ä¸ªæœˆä»¥åŽ, èƒ½å†æœ‰ä¸€ä¸ªæ˜Žæ˜¾çš„è¿›æ­¥. 

ä»Šå¤©èŠ±äº†å‡ ä¸ªå°æ—¶å¼„äº†ä¸€ä¸ªè‡ªå·±å®žçŽ°çš„promise, è¿˜ä¸æ˜¯å¾ˆå®Œå–„, æƒå½“ç»ƒä¹ äº†: 

```javascript
// promise æŽ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°, è¿™ä¸ªå‡½æ•°åˆæŽ¥å—resolveå’Œrejectä½œä¸ºå‚æ•°; å½“promiseå®Œæˆæ—¶resolveå‡½æ•°ä¼šè¢«ä»¥dataä¸ºå‚æ•°invoke
// é‚£ä¹ˆæˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯è‡ªå·±å®šä¹‰resolveå’Œreject, è®©ä»–ä»¬å…·æœ‰æ”¹å˜å†…éƒ¨çŠ¶æ€å’Œä¼ å‡ºdataçš„èƒ½åŠ›. å…·ä½“æ¥è¯´, å°±æ˜¯æ”¹å˜å†…éƒ¨çš„statusä¸º'resolved'ä¹‹åŽ, æŽ‰èµ·`this.then`ä¸­å®šä¹‰çš„æ–¹æ³•, æŠŠè¿™ä¸ªå€¼ä¼ é€’å‡ºåŽ»
const Promise2 = function (func) {
    // å†…éƒ¨çŠ¶æ€ - promiseçŠ¶æ€
    this.status = 'unfulfilled'
    // å†…éƒ¨çŠ¶æ€ - promise value
    this.promiseValue = null
    // thenå®šä¹‰çš„resolveå‡½æ•°
    this.thenResolve = null
    // thenå®šä¹‰çš„rejectå‡½æ•°
    this.thenReject = null
    // æˆ‘ä»¬å®šä¹‰çš„resolveå‡½æ•°, å…·æœ‰æ”¹å˜å†…éƒ¨çŠ¶æ€, ä¼ å€¼å‡ºåŽ»çš„èƒ½åŠ›
    const myResolve = data => {
        this.status = 'resolved'
        this.promiseValue = data
        // ä¹‹æ‰€ä»¥ç”¨setTimeout, æ˜¯å› ä¸ºæˆ‘ä»¬å¿…é¡»å…ˆç”¨`then`æ¥å®šä¹‰`this.thenResolve`å‡½æ•°çš„å€¼, æ‰èƒ½è°ƒç”¨`this.thenResolve`. ä¹Ÿå°±æ˜¯è¯´, å†…éƒ¨çš„`resolve`æ–¹æ³•å¿…é¡»å»¶åŽæ‰§è¡Œ
        setTimeout(() => {
            this.thenResolve(this.promiseValue)
            delete this.thenResolve  
        }, 0)
    }
    // æˆ‘ä»¬å®šä¹‰çš„rejectå‡½æ•°
    const myReject = err => {
        this.status = 'rejected'
        this.thenReject(null)
    }
    func(myResolve, myReject)
    return this
}


// åœ¨è¿™é‡Œæ ¹æ®thenä¼ å…¥çš„ä¸¤ä¸ªå‡½æ•°å®šä¹‰å†…éƒ¨çš„å€¼
Promise2.prototype.then = function (resolve, reject) {
    this.thenResolve = resolve
    this.thenReject = reject
}

// demo
new Promise2((resolve, reject) => {
    resolve('this is data')
})
.then(data => {
    console.log(data)
    return this
})
```